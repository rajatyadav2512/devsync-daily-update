name: Daily Repository Update

on:
  # Schedule the workflow to run once per day at 04:30 AM UTC
  schedule:
    - cron: '30 4 * * *' 
    
  # Allows manual triggering from the Actions tab
  workflow_dispatch:

jobs:
  commit_daily_update:
    runs-on: ubuntu-latest
    
    # CRITICAL FIX: Explicitly grant permission to write to the repository
    permissions:
      contents: write
      
    steps:
      - name: Checkout repository contents
        uses: actions/checkout@v4

      # NEW STEP: Create/Update a file with a timestamp to guarantee a change
      - name: Force file change with timestamp
        run: |
          DATE=$(date +%Y-%m-%d\ %H:%M:%S)
          echo "Last automated update: $DATE" > LAST_DAILY_UPDATE.txt
          
      # REQUIRED STEP: Includes your specific email in the step name
      - name: Daily update by 24f3002352@ds.study.iitm.ac.in
        # CORRECTED ACTION: Using the standard auto-commit action
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # We don't need commit_file now, as the previous step made the change
          commit_message: 'ðŸ¤– Automated daily repository heartbeat update'
          github_token: ${{ secrets.GITHUB_TOKEN }}
          commit_user_name: DevSync Automated Bot
          commit_user_email: bot@devsync.solutions
